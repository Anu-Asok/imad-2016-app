<!doctype html>
<html>

    <head>
        <link href="/ui/style.css" rel="stylesheet" />
        <link href="/ui/blog.png" rel="shortcut icon">
        <title>Blog</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
	</head>
	
	<body class="index">	
	<ul class="nav_bar">
	  <li><a class="active nav" href="/">Home</a></li>
	  <li><a class="nav" href="#news">Articles</a></li>
	  <li><a class="nav" href="#contact">Blog-Post</a></li>
	  <li ><a class="nav" href="/post">Post</a></li>
	  <li class="nav" style="float:right"><div id="check-login"><a href="/login">Login</a></div></li>
	  <li class="nav" style="float:right"><a href="/user">Profile</a></li>

	</ul>
	<br/>
	
	<div id="loader">
		<div id="gif">
			<img src="/ui/squares.gif"/>
		</div>
	</div>
	<br/>
	<div id="footer"></div>
	
	
	<script type="text/javascript">
		var loadby5=0;
		function check_login(){		
			var request=new XMLHttpRequest();		
			request.onreadystatechange=function(){
				if(request.status === 200){
						var div=document.getElementById('check-login');					
						div.innerHTML="<a href=\"/logout\">Logout</a>";
					}
			}
			request.open('GET',"/check-login",true);
			request.send(null);		
		}	
		check_login();
		function loader(){		
			var request=new XMLHttpRequest();
			if(loadby5!=0)
				document.getElementById('footer').innerHTML="<br/><button class=\"button\" id=\"load\" onclick=\"loader();\">Loading...</button>";
			request.onreadystatechange=function(){
				if(request.readyState === XMLHttpRequest.DONE){
					if(request.status === 200){					
					if(!(request.responseText).localeCompare("No articles found"))
					document.getElementById('footer').innerHTML="<p id=\"no-article\">No more Posts</p>";
					
						var div=document.getElementById('loader');					
						var comment=JSON.parse(request.responseText);	
						if(loadby5===1)
							var x='';														
						else
							var x=div.innerHTML;											
						for (i = 0; i < comment.length; i++) { 
						var time = new Date(comment[i].timestamp);
						x += "<div class=\"loader\"><div style=\"font-size:30px;font: normal normal 24px Times, Times New Roman, serif;\"><a href=\""+"\\articles\\"+comment[i].title+ "\">"+comment[i].heading+"</a></div>"+comment[i].content +"Likes: "+ comment[i].likes+"<br/><hr/>" +  "<em>Author: "+comment[i].name +' - '+ time.toLocaleTimeString() +" on "+ time.toLocaleDateString()+"<br/></div></em>";
						}
						div.innerHTML=x.toString();														
					document.getElementById('footer').innerHTML="<br/><button class=\"button\" id=\"load\" onclick=\"loader();\">Load More</button>";
					
					}					
				}				
			}
			
			request.open('GET',"/get-article/"+loadby5,true);
			request.send(null);		
			loadby5+=1;
		}		
		loader();
	</script>
	
    </body>
	
</html>








